@model MahERP.DataModelLayer.ViewModels.CrmViewModels.CrmOpportunityViewModel
@{
    Layout = null;
}

<div class="modal-dialog modal-lg" role="document">
    <div class="modal-content modal-contents">
        <div class="block block-rounded block-themed block-transparent mb-0">
            <div class="block-header bg-danger">
                <h3 class="block-title text-white">
                    <i class="fas fa-times-circle me-2"></i>ثبت از دست رفتن فرصت
                </h3>
                <div class="block-options">
                    <button aria-label="Close" class="btn-block-option" data-bs-dismiss="modal" type="button">
                        <i class="fa fa-fw fa-times"></i>
                    </button>
                </div>
            </div>
            
            <form asp-area="CrmArea" asp-controller="Opportunity" asp-action="MarkAsLost" method="post">
                @Html.AntiForgeryToken()
                <input type="hidden" asp-for="Id" />
                
                <div class="block-content">
                    <div class="alert alert-warning">
                        <i class="fas fa-exclamation-triangle me-2"></i>
                        فرصت <strong>@Model.Title</strong> به عنوان از دست رفته ثبت خواهد شد.
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">دلیل از دست رفتن <span class="text-danger">*</span></label>
                        <select name="LostReason" class="form-select" required>
                            <option value="">انتخاب کنید...</option>
                            @if (ViewBag.LostReasons != null)
                            {
                                @foreach (var reason in ViewBag.LostReasons as List<string>)
                                {
                                    <option value="@reason">@reason</option>
                                }
                            }
                        </select>
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">نام رقیب برنده (اختیاری)</label>
                        <input type="text" name="WinningCompetitor" class="form-control" placeholder="نام شرکت رقیب..." />
                        <small class="text-muted">اگر رقیب برنده شده، نام آن را وارد کنید</small>
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">یادداشت</label>
                        <textarea name="Note" class="form-control" rows="2" placeholder="توضیحات تکمیلی..."></textarea>
                    </div>
                </div>
                
                <div class="block-content block-content-full text-end bg-body">
                    <button class="btn btn-hero btn-secondary" data-bs-dismiss="modal" type="button">انصراف</button>
                    <button class="btn btn-hero btn-danger" data-save="modal-ajax-save" type="button">
                        <i class="fas fa-times-circle me-1"></i>
                        ثبت از دست رفتن
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
