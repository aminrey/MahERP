@model TaskViewModel
@{
    var isAssignedToCurrentUser = ViewBag.IsAssignedToCurrentUser ?? false;
    var isCompletedByMe = ViewBag.IsCompletedByMe ?? false;
}

<div class="tab-pane fade" id="tab-work-logs" role="tabpanel">
    <div class="block block-rounded block-fx-shadow">
        <div class="block-header bg-info text-white">
            <h3 class="block-title text-white mb-0">
                <i class="fa fa-clipboard-list me-2"></i>گزارش‌های کاری ثبت شده
            </h3>
            <div class="block-options">
                @if (isAssignedToCurrentUser && !isCompletedByMe)
                {
                    <button type="button" 
                            class="btn btn-sm btn-light" 
                            data-toggle="modal-ajax" 
                            href="@Url.Action("SubmitTaskWorkLogModal", "Tasks", new { taskId = Model.Id })">
                        <i class="fa fa-plus me-1"></i>ثبت گزارش جدید
                    </button>
                }
            </div>
        </div>
        <div class="block-content">
            <div id="work-logs-container">
                @{
                    ViewBag.TaskId = Model.Id;
                    ViewBag.IsAssignedToCurrentUser = isAssignedToCurrentUser;
                }
                @await Html.PartialAsync("_WorkLogsList", Model.WorkLogs)
            </div>
        </div>
    </div>
</div>
