@{

}

<!-- Sidebar -->
<nav aria-label="Main Navigation" id="sidebar">
    <!-- Side Header -->
    <div class="bg-header-dark">
        <div class="content-header bg-white-5">
            <!-- Logo -->
            <a asp-area="AdminArea" asp-controller="Dashboard" asp-action="Index" class="fw-semibold text-white tracking-wide">
                <span class="smini-visible">
                    <span class="opacity-75"></span>
                </span>
                <span class="smini-hidden">
                    Mah<span class="opacity-75">ERP</span>
                </span>
            </a>
            <!-- END Logo -->
            <!-- Options -->
            <div>
                <!-- Toggle Sidebar Style -->
                <button class="btn btn-sm btn-alt-secondary" data-class="fa-toggle-off fa-toggle-on" data-target="#sidebar-style-toggler" data-toggle="class-toggle" onclick="Dashmix.layout('sidebar_style_toggle');Dashmix.layout('header_style_toggle');" type="button">
                    <i class="fa fa-toggle-off" id="sidebar-style-toggler"></i>
                </button>
                <!-- END Toggle Sidebar Style -->
                <!-- Dark Mode -->
                <button class="btn btn-sm btn-alt-secondary" data-class="far fa" data-target="#dark-mode-toggler" data-toggle="class-toggle" onclick="Dashmix.layout('dark_mode_toggle');" type="button">
                    <i class="far fa-moon" id="dark-mode-toggler"></i>
                </button>
                <!-- END Dark Mode -->
                <!-- Close Sidebar, Visible only on mobile screens -->
                <button class="btn btn-sm btn-alt-secondary d-lg-none" data-action="sidebar_close" data-toggle="layout" type="button">
                    <i class="fa fa-times-circle"></i>
                </button>
                <!-- END Close Sidebar -->
            </div>
            <!-- END Options -->
        </div>
    </div>
    <!-- END Side Header -->
    <!-- Sidebar Scrolling -->
    <div class="js-sidebar-scroll">
        <!-- Side Navigation -->
        <div class="content-side">

            <ul class="nav-main">

                <li class="nav-main-heading">گزارشات</li>

                <li class="nav-main-item">
                    <a class="nav-main-link" asp-area="AdminArea" asp-controller="Dashboard" asp-action="Index">
                        <i class="nav-main-link-icon fa fa-tachometer-alt"></i>
                        <span class="nav-main-link-name">داشبورد</span>
                    </a>
                </li>

                <li class="nav-main-heading">طرف حسابها</li>

                <li class="nav-main-item">
                    <a aria-expanded="false" aria-haspopup="true" class="nav-main-link nav-main-link-submenu" data-toggle="submenu" href="#">
                        <i class="nav-main-link-icon fa fa-handshake"></i>
                        <span class="nav-main-link-name">طرف حساب</span>
                    </a>
                    <ul class="nav-main-submenu">
                        <li class="nav-main-item">
                            <a class="nav-main-link" asp-area="AdminArea" asp-controller="Stakeholder" asp-action="AddStakeholder">
                                <i class="nav-main-link-icon fa fa-plus-circle"></i>
                                <span class="nav-main-link-name">طرف حساب جدید</span>
                            </a>
                        </li>
                        <li class="nav-main-item">
                            <a class="nav-main-link" asp-area="AdminArea" asp-controller="Stakeholder" asp-action="Index">
                                <i class="nav-main-link-icon fa fa-list"></i>
                                <span class="nav-main-link-name">لیست طرف حساب‌ها</span>
                            </a>
                        </li>
                        <li class="nav-main-item">
                            <a class="nav-main-link" href="#" data-bs-toggle="modal" data-bs-target="#modal-advanced-search" onclick="loadAdvancedSearchModal()">
                                <i class="nav-main-link-icon fa fa-search"></i>
                                <span class="nav-main-link-name">جستجوی پیشرفته</span>
                            </a>
                        </li>
                    </ul>
                </li>





                <li class="nav-main-heading">عملیاتها</li>

                <!-- Task Management Section -->
                <li class="nav-main-item">
                    <a aria-expanded="false" aria-haspopup="true" class="nav-main-link nav-main-link-submenu" data-toggle="submenu" href="#">
                        <i class="nav-main-link-icon fa fa-tasks"></i>
                        <span class="nav-main-link-name">مدیریت تسک‌ها</span>
                    </a>
                    <ul class="nav-main-submenu">
                        <li class="nav-main-item">
                            <a class="nav-main-link" asp-area="AdminArea" asp-controller="Task" asp-action="Index">
                                <i class="nav-main-link-icon fa fa-list"></i>
                                <span class="nav-main-link-name">لیست تسک‌ها</span>
                            </a>
                        </li>
                        <li class="nav-main-item">
                            <a class="nav-main-link" asp-area="AdminArea" asp-controller="Task" asp-action="MyTasks">
                                <i class="nav-main-link-icon fa fa-clipboard-check"></i>
                                <span class="nav-main-link-name">تسک‌های من</span>
                            </a>
                        </li>
                        <li class="nav-main-item">
                            <a class="nav-main-link" asp-area="AdminArea" asp-controller="Task" asp-action="Create">
                                <i class="nav-main-link-icon fa fa-plus-circle"></i>
                                <span class="nav-main-link-name">تسک جدید</span>
                            </a>
                        </li>
                        <li class="nav-main-item">
                            <a class="nav-main-link" asp-area="AdminArea" asp-controller="TaskCategory" asp-action="Index">
                                <i class="nav-main-link-icon fa fa-tag"></i>
                                <span class="nav-main-link-name">دسته‌بندی‌ها</span>
                            </a>
                        </li>
                        <li class="nav-main-item">
                            <a class="nav-main-link" href="#" data-bs-toggle="modal" data-bs-target="#modal-advanced-search-task" onclick="loadTaskAdvancedSearchModal()">
                                <i class="nav-main-link-icon fa fa-search"></i>
                                <span class="nav-main-link-name">جستجوی پیشرفته</span>
                            </a>
                        </li>
                    </ul>
                </li>
                <!-- END Task Management Section -->
                <!-- در بخش navigation منوها -->
                <li class="nav-main-item">
                    <a class="nav-main-link nav-main-link-submenu" data-toggle="submenu" aria-haspopup="true" aria-expanded="false" href="#">
                        <i class="nav-main-link-icon fa fa-handshake"></i>
                        <span class="nav-main-link-name">مدیریت CRM</span>
                    </a>
                    <ul class="nav-main-submenu">
                        <li class="nav-main-item">
                            <a class="nav-main-link" href="@Url.Action("Index", "CRM", new { area = "AdminArea" })">
                                <span class="nav-main-link-name">تعاملات CRM</span>
                            </a>
                        </li>
                        <li class="nav-main-item">
                            <a class="nav-main-link" href="@Url.Action("Create", "CRM", new { area = "AdminArea" })">
                                <span class="nav-main-link-name">افزودن تعامل جدید</span>
                            </a>
                        </li>
                        <li class="nav-main-item">
                            <a class="nav-main-link" href="@Url.Action("MyInteractions", "CRM", new { area = "AdminArea" })">
                                <span class="nav-main-link-name">تعاملات من</span>
                            </a>
                        </li>
                        <li class="nav-main-item">
                            <a class="nav-main-link" href="@Url.Action("Statistics", "CRM", new { area = "AdminArea" })">
                                <span class="nav-main-link-name">آمار و گزارشات</span>
                            </a>
                        </li>
                    </ul>
                </li>

                <!-- User and Permission Management -->
                @if (User.IsInRole("Admin") || User.IsInRole("Manager"))
                {
                    <li class="nav-main-heading">مدیریت کاربران و دسترسی</li>
                    <li class="nav-main-item">
                        <a class="nav-main-link" asp-area="AdminArea" asp-controller="UserManager" asp-action="Index">
                            <i class="nav-main-link-icon fa fa-users"></i>
                            <span class="nav-main-link-name">مدیریت کاربران</span>
                        </a>
                    </li>
                    <li class="nav-main-item">
                        <a aria-expanded="false" aria-haspopup="true" class="nav-main-link nav-main-link-submenu" data-toggle="submenu" href="#">
                            <i class="nav-main-link-icon fa fa-shield-alt"></i>
                            <span class="nav-main-link-name">مدیریت نقش‌ها</span>
                        </a>
                        <ul class="nav-main-submenu">
                            <li class="nav-main-item">
                                <a class="nav-main-link" asp-area="AdminArea" asp-controller="RolePattern" asp-action="Index">
                                    <i class="nav-main-link-icon fa fa-key"></i>
                                    <span class="nav-main-link-name">الگوهای نقش</span>
                                </a>
                            </li>
                            <li class="nav-main-item">
                                <a class="nav-main-link" asp-area="AdminArea" asp-controller="UserPermission" asp-action="Index">
                                    <i class="nav-main-link-icon fa fa-users-cog"></i>
                                    <span class="nav-main-link-name">دسترسی کاربران</span>
                                </a>
                            </li>
                            <li class="nav-main-item">
                                <a class="nav-main-link" asp-area="AdminArea" asp-controller="UserPermission" asp-action="PermissionLogs">
                                    <i class="nav-main-link-icon fa fa-clipboard-list"></i>
                                    <span class="nav-main-link-name">لاگ دسترسی‌ها</span>
                                </a>
                            </li>
                        </ul>
                    </li>
                }

                <!-- System Settings -->
                @if (User.IsInRole("Admin"))
                {
                    <li class="nav-main-heading">تنظیمات سیستم</li>
                    <li class="nav-main-item">
                        <a class="nav-main-link" asp-area="AdminArea" asp-controller="Branch" asp-action="Index">
                            <i class="nav-main-link-icon fa fa-sitemap"></i>
                            <span class="nav-main-link-name">شعب</span>
                        </a>
                    </li>
                    <li class="nav-main-item">
                        <a class="nav-main-link" asp-area="AdminArea" asp-controller="Team" asp-action="Index">
                            <i class="nav-main-link-icon fa fa-users-cog"></i>
                            <span class="nav-main-link-name">تیم‌ها</span>
                        </a>
                    </li>
                }

                <li class="nav-main-item">
                    <a class="nav-main-link" href="javascript:void(0)" onclick="document.getElementById('logoutForm').submit();">
                        <i class="nav-main-link-icon fa fa-sign-out-alt"></i>
                        <span class="nav-main-link-name">خروج</span>
                    </a>
                </li>

            </ul>

        </div>
        <!-- END Side Navigation -->
    </div>
    <!-- END Sidebar Scrolling -->
</nav>
<!-- END Sidebar -->

<!-- Hidden Logout Form -->
<form id="logoutForm" asp-area="Identity" asp-page="/Account/Logout" asp-route-returnUrl="@Url.Action("Index", "Home", new { area = "" })" method="post" class="d-none">
    @Html.AntiForgeryToken()
</form>


<!-- Modal Advanced Search -->
<div class="modal fade" id="modal-advanced-search" tabindex="-1" role="dialog" aria-labelledby="modal-advanced-search" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content" id="advanced-search-content">
            <!-- Content will be loaded here via AJAX -->
        </div>
    </div>
</div>

<!-- Modal Advanced Search for Tasks -->
<div class="modal fade" id="modal-advanced-search-task" tabindex="-1" role="dialog" aria-labelledby="modal-advanced-search-task" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content" id="advanced-search-task-content">
            <!-- Content will be loaded here via AJAX -->
        </div>
    </div>
</div>

<!-- JavaScript for Advanced Search Modal -->
<script>
    function loadAdvancedSearchModal() {
        createAndShowModal('@Url.Action("AdvancedSearch", "Stakeholder", new { area = "AdminArea" })');
    }

    function loadTaskAdvancedSearchModal() {
        createAndShowModal('@Url.Action("AdvancedSearch", "Task", new { area = "AdminArea" })');
    }
</script>