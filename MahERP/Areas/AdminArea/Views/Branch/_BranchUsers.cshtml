@model BranchDetailsViewModel

<div class="d-flex justify-content-between align-items-center mb-4">
    <h4><i class="fa fa-users me-2 text-primary"></i>کاربران شعبه</h4>
    <a href="@Url.Action("AddUserToBranch", "Branch", new { branchId = Model.Id })" 
       class="btn btn-sm btn-success">
        <i class="fa fa-plus me-1"></i> افزودن کاربر
    </a>
</div>

@if (Model.BranchUsers != null && Model.BranchUsers.Any())
{
    <div class="table-responsive">
        <table class="table table-striped table-vcenter">
            <thead>
                <tr>
                    <th>نام کاربر</th>
                    <th>نقش</th>
                    <th>تاریخ انتساب</th>
                    <th class="text-center">وضعیت</th>
                    <th class="text-center">عملیات</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var user in Model.BranchUsers)
                {
                    <tr>
                        <td>@user.User.FirstName @user.User.LastName</td>
                        <td>
                            @switch (user.Role)
                            {
                                case 0: <span class="badge bg-info">کارشناس</span> break;
                                case 1: <span class="badge bg-warning">ناظر</span> break;
                                case 2: <span class="badge bg-success">مدیر</span> break;
                            }
                        </td>
                        <td>@ConvertDateTime.ConvertMiladiToShamsi(user.AssignDate, "yyyy/MM/dd")</td>
                        <td class="text-center">
                            <span class="badge bg-@(user.IsActive ? "success" : "danger")">
                                @(user.IsActive ? "فعال" : "غیرفعال")
                            </span>
                        </td>
                        <td class="text-center">
                            <a href="@Url.Action("EditBranchUser", "Branch", new { id = user.Id })" 
                               class="btn btn-sm btn-alt-secondary" title="ویرایش">
                                <i class="fa fa-pencil-alt"></i>
                            </a>
                            <button type="button" class="btn btn-sm btn-alt-danger" title="حذف"
                                    onclick="openModal('@Url.Action("RemoveUser", "Branch", new { id = user.Id })')">
                                <i class="fa fa-trash-alt"></i>
                            </button>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
}
else
{
    <div class="text-center py-5">
        <i class="fa fa-users fa-3x text-muted mb-3"></i>
        <p class="text-muted">هیچ کاربری به این شعبه اختصاص نیافته است</p>
        <a href="@Url.Action("AddUserToBranch", "Branch", new { branchId = Model.Id })" 
           class="btn btn-primary">
            <i class="fa fa-plus me-1"></i> افزودن اولین کاربر
        </a>
    </div>
}